<html xmlns:f="http://typo3.org/ns/fluid/ViewHelpers"
      xmlns:smartvote="http://typo3.org/ns/Visol/EasyvoteSmartvote/ViewHelpers">

<f:layout name="Default"/>

<f:section name="main">

	<h2 class="content-box">
		<f:translate key="who_to_elect"/>
	</h2>

	<smartvote:script file="{f:uri.resource(path:'JavaScript/Libraries/Underscore/underscore-min.js')}"/>
	<smartvote:script file="{f:uri.resource(path:'JavaScript/Libraries/Backbone/backbone-min.js')}"/>

	<f:comment><!-- Conditional loading of JS --></f:comment>
	<f:if condition="{smartvote:isUserAuthenticated()}">
		<f:then>
			<f:comment><!--The User is authenticated => persist data in its preferences --></f:comment>
			<smartvote:script file="{f:uri.resource(path:'JavaScript/Libraries/JQueryAjaxManager/jquery.ajaxmanager.js')}"/>
			<smartvote:script file="{f:uri.resource(path:'JavaScript/Libraries/BackboneSyncAjaxQueue/backbone.sync.ajaxman.js')}"/>
		</f:then>
		<f:else>
			<f:comment><!--The User is *not* authenticated => user the localStorage--></f:comment>
			<smartvote:script file="{f:uri.resource(path:'JavaScript/Libraries/BackboneLocalStorage/backbone.localStorage-min.js')}"/>
		</f:else>
	</f:if>

	<smartvote:script file="{f:uri.resource(path:'JavaScript/Libraries/D3/d3.min.js')}"/>
	<smartvote:script file="{f:uri.resource(path:'JavaScript/Build/Bundle.min.js')}"/>

	<button>Show my profile</button>

	<section id="container-questions">
		<div id="container-progress"></div>
		<div id="container-question-list"></div>
	</section>

	<script type="text/template" id="template-progress">
		<div class="progress">
			<div class="progress-bar progress-bar-striped"
			     role="progressbar"
			     aria-valuenow="<%- progress %>"
			     aria-valuemin="0"
			     aria-valuemax="100"
			     style="width: <%- progress %>%;">
				<%- numberOfQuestionAnswered %>  / <%- totalNumberOfQuestions %>
			</div>
		</div>
	</script>


	<script type="text/template" id="template-question">
		<form action="">
			<div class="question-name">
				<div class="question-name-left">
					<%- index %>
				</div>
				<div class="question-name-right">
					<%- name %>
				</div>
			</div>

			<div class="row" style="text-align: center">
				<div class="col-md-2 col-md-offset-2">
					<label>
						<span>
							<f:translate key="yes"/>
						</span>
						<br/>

						<input type="radio" class="btn-answer" name="weight" value="100"
						<%= answer === 100 ? 'checked' : '' %>
						/>
					</label>
				</div>
				<div class="col-md-2">
					<label>
						<span>
							<f:translate key="rather_yes"/>
						</span>
						<br/>

						<input type="radio" class="btn-answer" name="weight" value="75"
						<%= answer === 75 ? 'checked' : '' %>
						/>
					</label>
				</div>
				<div class="col-md-2">
					<label>
						<span>
							<f:translate key="rather_no"/>
						</span>
						<br/>

						<input type="radio" class="btn-answer" name="weight" value="25"
						<%= answer === 25 ? 'checked' : '' %>
						/>
					</label>
				</div>
				<div class="col-md-2">
					<label>
						<span>
							<f:translate key="no"/>
						</span>
						<br/>

						<input type="radio" class="btn-answer" name="weight" value="0"
						<%= answer === 0 ? 'checked' : '' %>
						/>
					</label>
				</div>
				<div class="col-md-2">
					<label>
						<span>
							<f:translate key="no_answer"/>
						</span>
						<br/>


						<input type="radio" class="btn-answer" name="weight" value="-1"
						<%= answer === -1 ? 'checked' : '' %>
						/>

					</label>
				</div>
			</div>
		</form>
		<hr/>
	</script>

	<script type="text/template" id="template-candidate">
		<div>First Name / Last name</div>
		<hr/>
	</script>


	<style>
		.question-name {
			min-width: 300px;
		}

		.question-name-left {
			float: left;
			width: 20px;
			margin-right: -20px;
			height: 100%;
		}

		.question-name-right {
			margin-left: 20px;
		}

		#container-questions label {
			font-weight: normal;
		}

		#container-questions label span {
			line-height: 25px;
			font-size: 90%;
		}

		#container-questions div[class|='col-md'] {
			padding: 0;
		}
	</style>

	<script>
		window.EasyvoteSmartvote = window.EasyvoteSmartvote || {};
		EasyvoteSmartvote.currentElection = '{currentElection.uid}';
		EasyvoteSmartvote.totalCleavage1 = '{currentElection.totalCleavage1}' - 0;
		EasyvoteSmartvote.totalCleavage2 = '{currentElection.totalCleavage2}' - 0;
		EasyvoteSmartvote.totalCleavage3 = '{currentElection.totalCleavage3}' - 0;
		EasyvoteSmartvote.totalCleavage4 = '{currentElection.totalCleavage4}' - 0;
		EasyvoteSmartvote.totalCleavage5 = '{currentElection.totalCleavage5}' - 0;
		EasyvoteSmartvote.totalCleavage6 = '{currentElection.totalCleavage6}' - 0;
		EasyvoteSmartvote.totalCleavage7 = '{currentElection.totalCleavage7}' - 0;
		EasyvoteSmartvote.totalCleavage8 = '{currentElection.totalCleavage8}' - 0;
		EasyvoteSmartvote.token = 'd{smartvote:token()}';
		EasyvoteSmartvote.isUserAuthenticated = {f:if(condition: "{smartvote:isUserAuthenticated()}", then: 'true', else: 'false')}
	</script>

</f:section>

</html>